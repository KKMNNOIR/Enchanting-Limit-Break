execute store result entity @s[predicate=ench_limit_break:max_levels/bane_of_arthropods] Item.tag.StoredEnchantments[{id:"minecraft:bane_of_arthropods"}].lvl short 1 run scoreboard players get @s BaneOfArthropods
execute store result entity @s[predicate=ench_limit_break:max_levels/blast_protection] Item.tag.StoredEnchantments[{id:"minecraft:blast_protection"}].lvl short 1 run scoreboard players get @s BlastProtection
execute store result entity @s[predicate=ench_limit_break:max_levels/efficiency] Item.tag.StoredEnchantments[{id:"minecraft:efficiency"}].lvl short 1 run scoreboard players get @s Efficiency
execute store result entity @s[predicate=ench_limit_break:max_levels/feather_falling] Item.tag.StoredEnchantments[{id:"minecraft:feather_falling"}].lvl short 1 run scoreboard players get @s FeatherFalling
execute store result entity @s[predicate=ench_limit_break:max_levels/fire_protection] Item.tag.StoredEnchantments[{id:"minecraft:fire_protection"}].lvl short 1 run scoreboard players get @s FireProtection
execute store result entity @s[predicate=ench_limit_break:max_levels/fortune] Item.tag.StoredEnchantments[{id:"minecraft:fortune"}].lvl short 1 run scoreboard players get @s Fortune
execute store result entity @s[predicate=ench_limit_break:max_levels/impaling] Item.tag.StoredEnchantments[{id:"minecraft:impaling"}].lvl short 1 run scoreboard players get @s Impaling
execute store result entity @s[predicate=ench_limit_break:max_levels/knockback] Item.tag.StoredEnchantments[{id:"minecraft:knockback"}].lvl short 1 run scoreboard players get @s Knockback
execute store result entity @s[predicate=ench_limit_break:max_levels/looting] Item.tag.StoredEnchantments[{id:"minecraft:looting"}].lvl short 1 run scoreboard players get @s Looting
execute store result entity @s[predicate=ench_limit_break:max_levels/luck_of_the_sea] Item.tag.StoredEnchantments[{id:"minecraft:luck_of_the_sea"}].lvl short 1 run scoreboard players get @s LuckOfTheSea
execute store result entity @s[predicate=ench_limit_break:max_levels/lure] Item.tag.StoredEnchantments[{id:"minecraft:lure"}].lvl short 1 run scoreboard players get @s Lure
execute store result entity @s[predicate=ench_limit_break:max_levels/piercing] Item.tag.StoredEnchantments[{id:"minecraft:piercing"}].lvl short 1 run scoreboard players get @s Piercing
execute store result entity @s[predicate=ench_limit_break:max_levels/power] Item.tag.StoredEnchantments[{id:"minecraft:power"}].lvl short 1 run scoreboard players get @s Power
execute store result entity @s[predicate=ench_limit_break:max_levels/projectile_protection] Item.tag.StoredEnchantments[{id:"minecraft:projectile_protection"}].lvl short 1 run scoreboard players get @s P.Protection
execute store result entity @s[predicate=ench_limit_break:max_levels/protection] Item.tag.StoredEnchantments[{id:"minecraft:protection"}].lvl short 1 run scoreboard players get @s Protection
execute store result entity @s[predicate=ench_limit_break:max_levels/punch] Item.tag.StoredEnchantments[{id:"minecraft:punch"}].lvl short 1 run scoreboard players get @s Punch
execute store result entity @s[predicate=ench_limit_break:max_levels/quick_charge] Item.tag.StoredEnchantments[{id:"minecraft:quick_charge"}].lvl short 1 run scoreboard players get @s QuickCharge
execute store result entity @s[predicate=ench_limit_break:max_levels/respiration] Item.tag.StoredEnchantments[{id:"minecraft:respiration"}].lvl short 1 run scoreboard players get @s Respiration
execute store result entity @s[predicate=ench_limit_break:max_levels/sharpness] Item.tag.StoredEnchantments[{id:"minecraft:sharpness"}].lvl short 1 run scoreboard players get @s Sharpness
execute store result entity @s[predicate=ench_limit_break:max_levels/smite] Item.tag.StoredEnchantments[{id:"minecraft:smite"}].lvl short 1 run scoreboard players get @s Smite
execute store result entity @s[predicate=ench_limit_break:max_levels/thorns] Item.tag.StoredEnchantments[{id:"minecraft:thorns"}].lvl short 1 run scoreboard players get @s Thorns
execute store result entity @s[predicate=ench_limit_break:max_levels/unbreaking] Item.tag.StoredEnchantments[{id:"minecraft:unbreaking"}].lvl short 1 run scoreboard players get @s Unbreaking
execute store result entity @s[predicate=ench_limit_break:max_levels/depth_strider] Item.tag.StoredEnchantments[{id:"minecraft:depth_strider"}].lvl short 1 run scoreboard players get @s DepthStrider
execute store result entity @s[predicate=ench_limit_break:max_levels/fire_aspect] Item.tag.StoredEnchantments[{id:"minecraft:fire_aspect"}].lvl short 1 run scoreboard players get @s FireAspect
execute store result entity @s[predicate=ench_limit_break:max_levels/frost_walker] Item.tag.StoredEnchantments[{id:"minecraft:frost_walker"}].lvl short 1 run scoreboard players get @s FrostWalker
execute store result entity @s[predicate=ench_limit_break:max_levels/loyalty,predicate=ench_limit_break:not_riptide] Item.tag.StoredEnchantments[{id:"minecraft:loyalty"}].lvl short 1 run scoreboard players get @s Loyalty
execute store result entity @s[predicate=ench_limit_break:max_levels/riptide] Item.tag.StoredEnchantments[{id:"minecraft:riptide"}].lvl short 1 unless predicate ench_limit_break:trident/except_riptide run scoreboard players get @s Riptide
execute store result entity @s[predicate=ench_limit_break:max_levels/sweeping] Item.tag.StoredEnchantments[{id:"minecraft:sweeping"}].lvl short 1 run scoreboard players get @s Sweeping
execute store result entity @s[predicate=ench_limit_break:max_levels/aqua_affinity] Item.tag.StoredEnchantments[{id:"minecraft:aqua_affinity"}].lvl short 1 run scoreboard players get @s AquaAffinity
execute store result entity @s[predicate=ench_limit_break:max_levels/channeling,predicate=ench_limit_break:not_riptide] Item.tag.StoredEnchantments[{id:"minecraft:channeling"}].lvl short 1 run scoreboard players get @s Channeling
execute store result entity @s[predicate=ench_limit_break:max_levels/flame] Item.tag.StoredEnchantments[{id:"minecraft:flame"}].lvl short 1 run scoreboard players get @s Flame
execute store result entity @s[predicate=ench_limit_break:max_levels/infinity] Item.tag.StoredEnchantments[{id:"minecraft:infinity"}].lvl short 1 run scoreboard players get @s Infinity
execute store result entity @s[predicate=ench_limit_break:max_levels/mending] Item.tag.StoredEnchantments[{id:"minecraft:mending"}].lvl short 1 run scoreboard players get @s Mending
execute store result entity @s[predicate=ench_limit_break:max_levels/multishot] Item.tag.StoredEnchantments[{id:"minecraft:multishot"}].lvl short 1 run scoreboard players get @s Multishot
execute store result entity @s[predicate=ench_limit_break:max_levels/silk_touch] Item.tag.StoredEnchantments[{id:"minecraft:silk_touch"}].lvl short 1 run scoreboard players get @s SilkTouch
execute store result entity @s[predicate=ench_limit_break:max_levels/soul_speed] Item.tag.StoredEnchantments[{id:"minecraft:soul_speed"}].lvl short 1 run scoreboard players get @s SoulSpeed

scoreboard players reset @e[type=item] BaneOfArthropods
scoreboard players reset @e[type=item] BlastProtection
scoreboard players reset @e[type=item] Efficiency
scoreboard players reset @e[type=item] FeatherFalling
scoreboard players reset @e[type=item] FireProtection
scoreboard players reset @e[type=item] Fortune
scoreboard players reset @e[type=item] Impaling
scoreboard players reset @e[type=item] Knockback
scoreboard players reset @e[type=item] Looting
scoreboard players reset @e[type=item] LuckOfTheSea
scoreboard players reset @e[type=item] Lure
scoreboard players reset @e[type=item] Piercing
scoreboard players reset @e[type=item] Power
scoreboard players reset @e[type=item] P.Protection
scoreboard players reset @e[type=item] Protection
scoreboard players reset @e[type=item] Punch
scoreboard players reset @e[type=item] QuickCharge
scoreboard players reset @e[type=item] Respiration
scoreboard players reset @e[type=item] Sharpness
scoreboard players reset @e[type=item] Smite
scoreboard players reset @e[type=item] Thorns
scoreboard players reset @e[type=item] Unbreaking
scoreboard players reset @e[type=item] DepthStrider
scoreboard players reset @e[type=item] FireAspect
scoreboard players reset @e[type=item] FrostWalker
scoreboard players reset @e[type=item] Loyalty
scoreboard players reset @e[type=item] Riptide
scoreboard players reset @e[type=item] Sweeping
scoreboard players reset @e[type=item] AquaAffinity
scoreboard players reset @e[type=item] Channeling
scoreboard players reset @e[type=item] Flame
scoreboard players reset @e[type=item] Infinity
scoreboard players reset @e[type=item] Mending
scoreboard players reset @e[type=item] Multishot
scoreboard players reset @e[type=item] SilkTouch
scoreboard players reset @e[type=item] SoulSpeed

execute as @e[tag=ench_to] at @s run function ench_limit_break:success
execute as @s[tag=ench_to] run kill @e[nbt={Item:{tag:{StoredEnchantments:[{}]}}},limit=1,sort=nearest,distance=..1,tag=!ench_to]
execute if entity @s[nbt={Item:{tag:{StoredEnchantments:[]}}}] run data remove entity @s Item.tag.StoredEnchantments